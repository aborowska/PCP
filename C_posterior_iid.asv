function d = C_posterior_iid(sigma, y, c)
    N = length(y);
    M = size(sigma,1);
    d = -Inf*ones(M,1);
    r = sigma>0; 
    
    
    ind = (y>=c);
    ind_N = lenght(ind);
    P = normcdf(X,MU,SIGMA)

    y_tilde = y;
    y_tilde(ind) = c;
    
    d(r) = -0.5*(ind_N*log(2*pi) + ind_N*log(sigma(r).^2) + sum(y(ind).^2)./sigma(r).^2);
    d(r) = d(r) + 
    
    % Misspecified model: N(0,sigma)
    prior = -log(sigma);
    d(r) = d(r) + prior(r);
end